

<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raksha Sutra</title>
    <style>
        /* --- Google Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:wght@400&family=Poppins:wght@400;600;700&display=swap');

        /* --- CSS Variables --- */
        :root {
            --primary-color: #e94d6e;
            --secondary-color: #f06595;
            --text-color: #34495e;
            --light-text-color: #f0f0f0;
            --card-bg: rgba(255, 255, 255, 0.4);
            --blur-effect: blur(10px);
        }

        /* --- General Styles --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #333; /* Fallback color */
            overflow: hidden;
            color: var(--text-color);
        }
        
        /* NEW: Blurred Background Image using pseudo-element */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: url('Leonardo_Phoenix_10_A_beautiful_festive_background_for_a_Raks_3.jpg') no-repeat center center/cover;
            filter: blur(5px);
            z-index: -1;
        }
        
        /* --- Page Container --- */
        .page {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            transition: opacity 0.7s ease-in-out, transform 0.7s ease-in-out;
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
            padding: 10px;
            text-align: center;
            overflow-y: auto;
        }

        .page.active {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }

        /* --- Landing Page --- */
        .title {
            font-family: 'Tiro Devanagari Hindi', serif;
            font-size: clamp(2.8rem, 8vw, 4.5rem);
            color: #fff;
            text-shadow: 3px 3px 10px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
        }

        .video-card {
            position: relative;
            width: 90vw;
            max-width: 600px;
            aspect-ratio: 16 / 9;
            background: var(--card-bg);
            backdrop-filter: var(--blur-effect);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .video-card video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .subtitle { margin-top: 25px; font-size: clamp(0.9rem, 2.5vw, 1.1rem); color: var(--light-text-color); max-width: 600px; text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5); padding: 0 15px; }

        .cta-button {
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #fff;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 50px;
            cursor: pointer;
            text-decoration: none;
            box-shadow: 0 10px 25px rgba(233, 77, 110, 0.4);
            transition: all 0.3s ease;
            margin-top: 20px;
        }
        .cta-button:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(233, 77, 110, 0.5); }
        .cta-button:disabled { background: #ccc; cursor: not-allowed; }

        /* --- Speaker Icon --- */
        #speaker-icon { position: fixed; top: 20px; right: 20px; font-size: 1.8rem; color: white; cursor: pointer; z-index: 1000; text-shadow: 2px 2px 5px rgba(0,0,0,0.4); }

        /* --- Form & Profile Page --- */
        .form-container { width: 90%; max-width: 450px; padding: 40px 30px; background: var(--card-bg); backdrop-filter: var(--blur-effect); border: 1px solid rgba(255, 255, 255, 0.4); border-radius: 20px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2); }
        .form-container h2 { font-family: 'Poppins', serif; font-size: 2rem; color: var(--text-color); margin-bottom: 30px; }
        .input-group { margin-bottom: 20px; position: relative;}
        .input-field { width: 100%; padding: 15px; border: 1px solid rgba(0,0,0,0.1); border-radius: 10px; background-color: rgba(255,255,255,0.7); font-size: 1rem; color: var(--text-color); }
        .back-link { display: inline-block; margin-top: 15px; color: var(--text-color); text-decoration: none; font-weight: 600; }
        
        /* --- Home Page --- */
        #home-page { justify-content: space-between; padding: 80px 20px 20px 20px; }
        .home-header { position: absolute; top: 0; left: 0; width: 100%; padding: 20px; background: rgba(0,0,0,0.2); backdrop-filter: blur(5px); z-index: 10; }
        .home-header .title { margin: 0; font-size: 2rem; text-align: center; }
        #home-page .content-area { display: flex; flex-direction: column; align-items: center; width: 100%; gap: 25px; max-width: 500px; flex-grow: 1; justify-content: center; }
        .cards-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; width: 100%; }
        .home-card-wrapper { display: flex; flex-direction: column; align-items: center; gap: 15px; }
        .home-card { width: 100%; aspect-ratio: 1 / 1; background-size: cover; background-position: center; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); cursor: pointer; transition: transform 0.3s ease; }
        .home-card:hover { transform: scale(1.05); }
        #home-page .cta-button { margin-top: 0; width: 100%; padding: 12px 20px; font-size: 1rem; }
        .home-footer { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 15px; margin-top: auto; padding-top:20px; }
        .footer-strip { width: 100%; padding: 15px 25px; font-size: 1.1rem; font-weight: 600; color: #fff; background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 15px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 10px; }
        
        /* --- FIXED: Main Interface Page Layout --- */
        #main-interface-page { overflow: hidden; }
        #main-interface-page .page-content { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; padding: 10px; gap: 20px; }
        .interface-layout { display: flex; flex-direction: row; align-items: stretch; justify-content: center; gap: 10px; width: 100%; height: 75vh; max-height: 550px; }
        
        .main-content-card {
            width: 48%; /* Use percentage for responsiveness */
            max-width: 300px;
            aspect-ratio: 9 / 16;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            position: relative;
            flex-shrink: 0;
            border: 2px solid rgba(255,255,255,0.5);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        #main-interface-video-card video { width: 100%; height: 100%; object-fit: cover; }
        
        #main-interface-message-card {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: var(--blur-effect);
            padding: 20px;
        }

        #main-interface-message { 
            color: white; 
            text-shadow: 1px 1px 4px rgba(0,0,0,0.7); 
            font-size: clamp(0.7rem, 2vw, 0.8rem); 
            line-height: 1.6; 
            white-space: pre-wrap; 
            text-align: left; 
            overflow-y: auto; 
            flex-grow: 1;
        }
        
        #mystery-box-btn { font-size: 3rem; padding: 10px; width: auto; border:none; background: none; cursor: pointer; transition: all 0.3s ease; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.4)); animation: pulse 2s infinite; }
        #mystery-box-btn:hover { animation: none; transform: scale(1.1); }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- Attractive Message Display Page --- */
        #message-display-page { padding: 0; background: linear-gradient(45deg, #6a11cb, #2575fc); }
        .full-screen-card {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
        }
        .message-card-header {
            position: absolute;
            top: 20px;
            width: calc(100% - 40px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }
        .card-action-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            backdrop-filter: blur(5px);
        }
        #message-display-content {
            width: 90vw;
            max-width: 400px;
            height: 75vh;
            max-height: 600px;
            background: var(--card-bg);
            backdrop-filter: var(--blur-effect);
            border-radius: 25px;
            padding: 40px 25px;
            color: var(--text-color);
            font-size: 1.1rem;
            line-height: 1.8;
            text-align: center;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .swipe-hint {
            position: absolute;
            bottom: 25px;
            color: rgba(255, 255, 255, 0.8);
            font-style: italic;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>

<audio id="background-audio" loop><source src="3.m4a" type="audio/mp4"></audio>
<audio id="shubhzone-audio" loop><source src="shubhzone_message.m4a" type="audio/mp4"></audio>

<div id="speaker-icon">üîá</div>

<!-- Page 1: Landing Page -->
<div id="landing-page" class="page active">
    <h1 class="title">Raksha Sutra</h1>
    <div class="video-card"><video autoplay loop muted playsinline><source src="rakhi_promo.mp4" type="video/mp4"></video></div>
    <p class="subtitle">"‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§è‡§ï ‡§ß‡§æ‡§ó‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§¶‡§ø‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§è‡§ï ‡§Ö‡§ü‡•Ç‡§ü ‡§¨‡§Ç‡§ß‡§® ‡§π‡•à‡•§<br>‡§Ü‡§á‡§è ‡§á‡§∏ ‡§∞‡§ø‡§∂‡•ç‡§§‡•á ‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§Æ‡§π‡§∏‡•Ç‡§∏ ‡§ï‡§∞‡•á‡§Ç, ‡§è‡§ï ‡§™‡•ç‡§Ø‡§æ‡§∞ ‡§≠‡§∞‡•Ä ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∞‡§æ‡§ñ‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§•‡•§"</p>
    <button id="get-started-btn" class.cta-button">‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
</div>

<!-- Page 2: Info Form Page -->
<div id="form-page" class="page">
    <div class="form-container">
        <h2>‡§Ö‡§™‡§®‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç</h2>
        <form id="info-form">
            <div class="input-group"><input type="text" id="name" class="input-field" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ" required></div>
            <div class="input-group"><input type="tel" id="phone" class="input-field" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (‡§Ø‡§π ‡§Ü‡§™‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§π‡•ã‡§ó‡•Ä)" required></div>
            <div class="input-group"><textarea id="address" rows="3" class="input-field" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ" required></textarea></div>
            <button type="submit" class="cta-button">‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
        </form>
    </div>
</div>

<!-- Page 3: Main Interface Page -->
<div id="main-interface-page" class="page">
    <div class="page-content">
        <div class="interface-layout">
            <div id="main-interface-video-card" class="main-content-card">
                <video playsinline id="main-video-player" muted></video>
            </div>
            <div id="main-interface-message-card" class="main-content-card">
                <div id="main-interface-message"></div>
            </div>
        </div>
        <button id="mystery-box-btn">üéÅ</button>
    </div>
</div>

<!-- Page 4: Home Page -->
<div id="home-page" class="page">
    <header class="home-header"><h1 class="title">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞</h1></header>
    <div class="content-area">
        <div class="cards-container">
            <div class="home-card-wrapper">
                <div class="home-card" style="background-image: url('IMG-20250807-WA0000.jpg');" onclick="document.getElementById('open-message-creator-btn').click();"></div>
                <button id="open-message-creator-btn" class="cta-button">‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡•á‡§Ç</button>
            </div>
            <div class="home-card-wrapper">
                <div class="home-card" style="background-image: url('Leonardo_Phoenix_10_A_beautifully_designed_Raksha_Bandhan_Mass_1.jpg');" onclick="document.getElementById('open-card-creator-btn').click();"></div>
                <button id="open-card-creator-btn" class="cta-button">‡§ï‡§æ‡§∞‡•ç‡§° ‡§¨‡§®‡§æ‡§è‡§Ç</button>
            </div>
        </div>
    </div>
    <div class="home-footer">
        <div id="my-profile-strip" class="footer-strip">‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤</div>
        <div id="change-music-strip" class="footer-strip">‡§∏‡§Ç‡§ó‡•Ä‡§§ ‡§¨‡§¶‡§≤‡•á‡§Ç</div>
        <div id="whatsapp-share-strip" class="footer-strip">
             <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M.05 22c.12-.59.25-1.18.41-1.76l.09-.32c.31-1.09.7-2.14 1.18-3.15.53-1.12 1.16-2.19 1.88-3.18.82-1.1 1.74-2.1 2.76-3 .2-.18.4-.36.6-.53l.4-.33c.53-.44 1.1-.82 1.7-1.14.99-.53 2.03-.9 3.1-1.1.33-.07.67-.12 1.01-.16.29-.03.59-.05.88-.05.23 0 .46.01.69.03.37.03.74.08 1.1.15.99.19 1.94.55 2.83 1.06.88.5 1.69 1.14 2.41 1.89s1.25 1.53 1.75 2.41c.45.83.78 1.71 1 2.62.22.91.31 1.85.28 2.79-.03.95-.2 1.89-.51 2.79-.31.9-.76 1.76-1.33 2.55-.57.79-1.25 1.5-2.02 2.11-.78.6-1.63 1.1-2.54 1.49-.91.38-1.88.64-2.86.76-.98.12-1.97.1-2.95-.05-.98-.15-1.95-.44-2.88-.86a12.926 12.926 0 01-2.7-1.48c-.24-.13-.47-.27-.7-.41l-1.68-1.02c-.55-.33-1.1-.68-1.64-1.05-.1-.07-.2-.14-.3-.21l-.06-.05c-.62-.48-1.2-1-1.73-1.57-.49-.52-.93-1.08-1.32-1.68-.3-.46-.55-.95-.77-1.45l-.02-.06c-.25-.56-.47-1.14-.65-1.73l-.04-.13c-.22-.72-.39-1.46-.5-2.22-.05-.33-.08-.67-.1-1H.05zM9.3 8.35c.14-.38.33-.74.58-1.06.25-.32.55-.6.88-.82.34-.22.7-.4 1.08-.52s.78-.18 1.18-.18c.39 0 .78.04 1.15.13.37.09.73.23 1.06.41.33.18.64.41.91.68.27.27.5.58.68.91.18.33.31.69.4 1.06.09.37.13.76.13 1.15s-.04.78-.13 1.15c-.09.37-.22.73-.4 1.06-.18.33-.41.64-.68.91-.27.27-.58.5-.91.68-.33.18-.69.32-1.06.41-.37-.09-.76.13-1.15.13s-.78-.04-1.15-.13c-.37-.09-.73-.23-1.06-.41-.33-.18-.64-.41-.91-.68-.27-.27-.5-.58-.68-.91-.18-.33-.31-.69-.4-1.06-.09-.37-.13-.76-.13-1.15s.05-.78.14-1.15z"/></svg>
            <span>‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§™‡§∞ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</span>
        </div>
        <div id="view-shared-strip" class="footer-strip">‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡•á‡§Ç</div>
    </div>
</div>

<!-- Page 5: Profile Page -->
<div id="profile-page" class="page">
    <div class="form-container">
        <h2>‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤</h2>
        <div class="profile-info">
            <p>‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ:</p>
            <div class="input-group"><input type="text" id="profile-name-input" class="input-field" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required></div>
            <p>‡§Ü‡§™‡§ï‡§æ ‡§™‡§§‡§æ:</p>
            <div class="input-group"><textarea id="profile-address-input" class="input-field" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§™‡§§‡§æ" rows="3" required></textarea></div>
            <p>‡§Ü‡§™‡§ï‡•Ä ‡§Ü‡§à‡§°‡•Ä: <span id="profile-call-id">‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</span></p>
        </div>
        <button id="update-profile-btn" class="cta-button">‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
        <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 6: Music Change Page -->
<div id="music-page" class="page">
     <div class="form-container">
        <h2>‡§∏‡§Ç‡§ó‡•Ä‡§§ ‡§¨‡§¶‡§≤‡•á‡§Ç</h2>
        <button class="cta-button music-btn" data-src="1.m4a">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ó‡•Ä‡§§ 1</button>
        <button class="cta-button music-btn" data-src="2.m4a">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ó‡•Ä‡§§ 2</button>
        <button class="cta-button music-btn" data-src="3.m4a">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ó‡•Ä‡§§ 3</button>
        <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 7: Message Creator Page -->
<div id="message-creator-page" class="page">
    <div class="form-container">
        <h2>‡§è‡§ï ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¨‡§®‡§æ‡§è‡§Ç</h2>
        <button id="bhai-to-bhen-btn" class="cta-button" style="width:100%; margin-bottom: 15px;">‡§≠‡§æ‡§à ‡§ï‡•Ä ‡§§‡§∞‡§´ ‡§∏‡•á ‡§¨‡§π‡§® ‡§ï‡•á ‡§≤‡§ø‡§è</button>
        <button id="bhen-to-bhai-btn" class="cta-button" style="width:100%;">‡§¨‡§π‡§® ‡§ï‡•Ä ‡§§‡§∞‡§´ ‡§∏‡•á ‡§≠‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è</button>
         <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 8: Name Input for Messages -->
<div id="message-name-form-page" class="page">
    <div class="form-container">
        <h2 id="message-name-title">‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</h2>
        <form id="message-name-form">
            <div class="input-group"><input type="text" id="sender-name" class="input-field" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required></div>
            <div class="input-group"><input type="text" id="receiver-name" class="input-field" placeholder="‡§≠‡§æ‡§à/‡§¨‡§π‡§® ‡§ï‡§æ ‡§®‡§æ‡§Æ" required></div>
            <button type="submit" class="cta-button">‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
        </form>
        <a href="#" class="back-link" data-target="message-creator-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 9: Message Display Page -->
<div id="message-display-page" class="page">
     <div class="full-screen-card">
        <div class="message-card-header">
            <button id="message-back-btn" class="card-action-btn">‡§µ‡§æ‡§™‡§∏</button>
            <button id="message-share-btn" class="card-action-btn">‡§∂‡•á‡§Ø‡§∞</button>
        </div>
        <div id="message-display-content"></div>
        <p class="swipe-hint">‡§Ö‡§ó‡§≤‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡§æ‡§è‡§Ç ‡§Ø‡§æ ‡§¨‡§æ‡§è‡§Ç ‡§∏‡•ç‡§µ‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç</p>
     </div>
</div>

<!-- Firebase SDKs -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
    
    // Your Firebase config object
    const firebaseConfig = {
        apiKey: "AIzaSyB2PG5JvDko2UmQDlY9gN5lBgga2vQy-Ws",
        authDomain: "conceptra-c1000.firebaseapp.com",
        databaseURL: "https://conceptra-c1000-default-rtdb.firebaseio.com",
        projectId: "conceptra-c1000",
        storageBucket: "conceptra-c1000.firebasestorage.app",
        messagingSenderId: "298402987968",
        appId: "1:298402987968:web:c0d0d7d6c08cdfa6bc5225",
        measurementId: "G-QRQYEVSJJ6"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // DOM Elements
    const pages = document.querySelectorAll('.page');
    const backgroundAudio = document.getElementById('background-audio');
    const shubhzoneAudio = document.getElementById('shubhzone-audio');
    const speakerIcon = document.getElementById('speaker-icon');
    const mainVideoPlayer = document.getElementById('main-video-player');

    // State Variables
    let isMusicPlaying = false;
    let messageType = ''; 
    let currentMessageIndex = 0;
    
    const mainInterfaceVideos = [
        'main interfacemp4.mp4', 
        'Generated File August 07, 2025 - 7_34PM.mp4', 
        'Happy Rakshabandhan üéä‚ú®ü™î __ Coming soon üéä __ _rakshabandhan _status _viral(360P).mp4'
    ];
    let currentMainVideoIndex = 0;
    
    // --- Core Functions ---
    function showPage(pageId) {
        // Stop all media before switching pages
        backgroundAudio.pause();
        shubhzoneAudio.pause();
        mainVideoPlayer.pause();
        
        // Restore background audio volume if it was lowered
        backgroundAudio.volume = 1.0;

        pages.forEach(p => p.classList.remove('active'));
        const newPage = document.getElementById(pageId);
        if (newPage) newPage.classList.add('active');

        // Page-specific actions
        if (pageId === 'main-interface-page') {
            speakerIcon.style.display = 'none'; // Hide general music speaker
            mainVideoPlayer.play().catch(e => console.error("Main video autoplay failed:", e));
            shubhzoneAudio.play().catch(e => console.error("Shubhzone audio autoplay failed:", e));
            
            // Lower background music volume if it's playing
            if (isMusicPlaying) {
                backgroundAudio.volume = 0.2; // Lower volume
                backgroundAudio.play(); // Continue playing at lower volume
            }
        } else {
            speakerIcon.style.display = 'block'; // Show general music speaker on other pages
            if (isMusicPlaying) {
                backgroundAudio.play();
            }
        }
    }

    function setupMainInterfacePage(userName) {
        const messageText = `‡§™‡•ç‡§∞‡§ø‡§Ø ${userName},\n\n‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡§æ ‡§Ø‡§π ‡§™‡§æ‡§µ‡§® ‡§™‡§∞‡•ç‡§µ ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§è‡§ï ‡§ß‡§æ‡§ó‡§æ ‡§¨‡§æ‡§Ç‡§ß‡§®‡•á ‡§ï‡•Ä ‡§™‡§∞‡§Ç‡§™‡§∞‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§™‡•ç‡§∞‡•á‡§Æ, ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§î‡§∞ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§ï‡§æ ‡§µ‡§π ‡§Ö‡§®‡§Æ‡•ã‡§≤ ‡§µ‡§ö‡§® ‡§π‡•à, ‡§ú‡•ã ‡§è‡§ï ‡§≠‡§æ‡§à-‡§¨‡§π‡§® ‡§ï‡•ã ‡§ú‡•Ä‡§µ‡§®‡§≠‡§∞ ‡§ú‡•ã‡§°‡§º‡•á ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à‡•§\n\n‡§Ü‡§ú, ‡§ú‡§¨ ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§§‡•á‡§ú‡§º‡•Ä ‡§∏‡•á ‡§¨‡§¶‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à ‡§î‡§∞ ‡§¶‡•Ç‡§∞‡•Ä ‡§π‡§Æ‡•á‡§Ç ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§∂‡§π‡§∞‡•ã‡§Ç ‡§µ ‡§¶‡•á‡§∂‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§≤‡•á ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à, ‡§∞‡§æ‡§ñ‡•Ä ‡§ï‡§æ ‡§Ø‡§π ‡§ß‡§æ‡§ó‡§æ ‡§π‡§Æ‡•á‡§Ç ‡§Ø‡§æ‡§¶ ‡§¶‡§ø‡§≤‡§æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø ‡§∞‡§ø‡§∂‡•ç‡§§‡•á ‡§¶‡•Ç‡§∞‡•Ä ‡§∏‡•á ‡§®‡§π‡•Ä‡§Ç, ‡§¶‡§ø‡§≤‡•ã‡§Ç ‡§ï‡•Ä ‡§®‡§ú‡§º‡§¶‡•Ä‡§ï‡§ø‡§Ø‡•ã‡§Ç ‡§∏‡•á ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§\n\n‡§π‡§Æ‡§æ‡§∞‡•á Shubhzone.shop ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞ ‡§ï‡§æ ‡§π‡§ø‡§∏‡•ç‡§∏‡§æ ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ ‡§Ü‡§™‡§ï‡•á ‡§Ü‡§≠‡§æ‡§∞‡•Ä ‡§π‡•à‡§Ç‡•§ ‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§î‡§∞ ‡§∏‡§æ‡§• ‡§π‡§Æ‡§æ‡§∞‡•á ‡§≤‡§ø‡§è ‡§µ‡•à‡§∏‡§æ ‡§π‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡§æ ‡§è‡§ï ‡§¨‡§π‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•á ‡§≠‡§æ‡§à ‡§ï‡§æ ‡§µ‡§ö‡§®‚Äî ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§®‡•á ‡§î‡§∞ ‡§∏‡§æ‡§• ‡§®‡§ø‡§≠‡§æ‡§®‡•á ‡§ï‡§æ‡•§\n\n‡§π‡§Æ‡§æ‡§∞‡§æ ‡§µ‡§æ‡§¶‡§æ ‡§π‡•à ‡§ï‡§ø ‡§ú‡§ø‡§∏ ‡§§‡§∞‡§π ‡§è‡§ï ‡§≠‡§æ‡§à-‡§¨‡§π‡§® ‡§ú‡•Ä‡§µ‡§® ‡§ï‡•á ‡§π‡§∞ ‡§Æ‡•ã‡§°‡§º ‡§™‡§∞ ‡§è‡§ï-‡§¶‡•Ç‡§∏‡§∞‡•á ‡§ï‡§æ ‡§∏‡§æ‡§• ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç, ‡§µ‡•à‡§∏‡•á ‡§π‡•Ä ‡§π‡§Æ ‡§≠‡•Ä ‡§π‡§Æ‡•á‡§∂‡§æ ‡§Ü‡§™‡§ï‡•á ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡•ã ‡§¨‡•á‡§π‡§§‡§∞ ‡§¨‡§®‡§æ‡§®‡•á, ‡§Ü‡§™‡§ï‡•Ä ‡§ú‡§∞‡•Ç‡§∞‡§§‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Æ‡§ù‡§®‡•á ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•ã ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§, ‡§Ü‡§∏‡§æ‡§® ‡§î‡§∞ ‡§Ü‡§®‡§Ç‡§¶‡§¶‡§æ‡§Ø‡§ï ‡§∏‡•á‡§µ‡§æ ‡§¶‡•á‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏‡§∞‡§§ ‡§∞‡§π‡•á‡§Ç‡§ó‡•á‡•§\n\n‡§á‡§∏ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§™‡§∞ ‡§π‡§Æ ‡§¶‡•Å‡§Ü ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•á ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§Æ‡§ø‡§†‡§æ‡§∏, ‡§∏‡§´‡§≤‡§§‡§æ‡§ì‡§Ç ‡§ï‡•Ä ‡§∏‡•å‡§ó‡§æ‡§§ ‡§î‡§∞ ‡§∞‡§ø‡§∂‡•ç‡§§‡•ã‡§Ç ‡§ï‡•Ä ‡§ó‡§∞‡•ç‡§Æ‡§æ‡§π‡§ü ‡§π‡§Æ‡•á‡§∂‡§æ ‡§¨‡§®‡•Ä ‡§∞‡§π‡•á‡•§\n\n‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§™‡•Ç‡§∞‡•Ä ‡§ü‡•Ä‡§Æ ‡§ï‡•Ä ‡§ì‡§∞ ‡§∏‡•á ‡§Ü‡§™‡§ï‡•ã ‡§î‡§∞ ‡§Ü‡§™‡§ï‡•á ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞ ‡§ï‡•ã ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡•Ä ‡§π‡§æ‡§∞‡•ç‡§¶‡§ø‡§ï ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç!\n\n‡§∏‡§™‡•ç‡§∞‡•á‡§Æ,\nShubhzone.shop ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞`;
        
        document.getElementById('main-interface-message').textContent = messageText;
        currentMainVideoIndex = 0;
        mainVideoPlayer.src = mainInterfaceVideos[currentMainVideoIndex];
        showPage('main-interface-page');
    }

    function playNextMainVideo() {
        currentMainVideoIndex = (currentMainVideoIndex + 1) % mainInterfaceVideos.length;
        mainVideoPlayer.src = mainInterfaceVideos[currentMainVideoIndex];
        mainVideoPlayer.play();
    }
    
    // --- Event Listeners ---

    // Initial Load
    window.addEventListener('load', () => showPage('landing-page'));

    // Speaker Icon for General Music
    speakerIcon.addEventListener('click', () => {
        if (backgroundAudio.paused) {
            backgroundAudio.play().then(() => {
                speakerIcon.textContent = 'üîä';
                isMusicPlaying = true;
            });
        } else {
            backgroundAudio.pause();
            speakerIcon.textContent = 'üîá';
            isMusicPlaying = false;
        }
    });

    // Get Started Button
    document.getElementById('get-started-btn').addEventListener('click', () => {
        // A user interaction is required for browsers to allow autoplay
        backgroundAudio.play().then(() => backgroundAudio.pause());
        shubhzoneAudio.play().then(() => shubhzoneAudio.pause());
        
        const userName = localStorage.getItem('rakshaSutraUserName');
        if (userName) {
            setupMainInterfacePage(userName);
        } else {
            showPage('form-page');
        }
    });
    
    // Info Form Submission
    document.getElementById('info-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const phone = document.getElementById('phone').value;
        const name = document.getElementById('name').value;
        const address = document.getElementById('address').value;
        
        // Save to localStorage
        localStorage.setItem('rakshaSutraUserName', name);
        localStorage.setItem('rakshaSutraUserId', phone);
        
        // Save to Firebase (ensure your rules are open for this to work)
        try {
            await setDoc(doc(db, "users", phone), { name, phone, address });
        } catch (error) {
            console.error("Firebase write error:", error);
            alert("‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§∏‡§π‡•á‡§ú‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§");
        }
        
        setupMainInterfacePage(name);
    });
    
    // Main Video Playlist
    mainVideoPlayer.addEventListener('ended', playNextMainVideo);

    // Mystery Box Button
    document.getElementById('mystery-box-btn').addEventListener('click', () => showPage('home-page'));

    // --- Buttons on "Create Message" Page ---
    document.getElementById('bhai-to-bhen-btn').addEventListener('click', () => {
        messageType = 'bhai-to-bhen';
        showPage('message-name-form-page');
    });

    document.getElementById('bhen-to-bhai-btn').addEventListener('click', () => {
        messageType = 'bhen-to-bhai';
        showPage('message-name-form-page');
    });
    
    // Other Buttons from Home Page
    document.getElementById('open-message-creator-btn').addEventListener('click', () => showPage('message-creator-page'));
    document.getElementById('my-profile-strip').addEventListener('click', () => showPage('profile-page'));
    document.getElementById('change-music-strip').addEventListener('click', () => showPage('music-page'));
    // Add other event listeners as needed...

    // Back link functionality
    document.querySelectorAll('.back-link').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            showPage(link.dataset.target);
        });
    });

</script>
</body>
</html>
