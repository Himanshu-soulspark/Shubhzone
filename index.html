

<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raksha Sutra</title>
    <style>
        /* --- Google Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Tiro+Devanagari+Hindi:wght@400&family=Poppins:wght@400;600;700&display=swap');

/* --- CSS Variables --- */
    :root {
        --primary-color: #e94d6e;
        --secondary-color: #f06595;
        --text-color: #34495e;
        --light-text-color: #f0f0f0;
        --card-bg: rgba(255, 255, 255, 0.4);
        --blur-effect: blur(10px);
    }

    /* --- General Styles --- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { height: 100%; }

    body {
        font-family: 'Poppins', sans-serif;
        background: url('Leonardo_Phoenix_10_A_beautiful_festive_background_for_a_Raks_3.jpg') no-repeat center center/cover;
        overflow: hidden;
        color: var(--text-color);
    }
    
    /* --- Page Container --- */
    .page {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        transition: opacity 0.7s ease-in-out, transform 0.7s ease-in-out;
        opacity: 0;
        transform: scale(0.95);
        pointer-events: none;
        padding: 20px;
        text-align: center;
        overflow-y: auto;
    }

    .page.active {
        opacity: 1;
        transform: scale(1);
        pointer-events: auto;
    }

    /* --- Landing Page --- */
    .title {
        font-family: 'Tiro Devanagari Hindi', serif;
        font-size: clamp(2.8rem, 8vw, 4.5rem);
        color: #fff;
        text-shadow: 3px 3px 10px rgba(0, 0, 0, 0.5);
        margin-bottom: 20px;
    }

    .video-card {
        position: relative;
        width: 90vw;
        max-width: 600px;
        aspect-ratio: 16 / 9;
        background: var(--card-bg);
        backdrop-filter: var(--blur-effect);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        overflow: hidden;
    }

    .video-card video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
    .subtitle { margin-top: 25px; font-size: clamp(0.9rem, 2.5vw, 1.1rem); color: var(--light-text-color); max-width: 600px; text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.5); padding: 0 15px; }

    .cta-button {
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: 600;
        color: #fff;
        background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
        border: none;
        border-radius: 50px;
        cursor: pointer;
        text-decoration: none;
        box-shadow: 0 10px 25px rgba(233, 77, 110, 0.4);
        transition: all 0.3s ease;
        margin-top: 20px;
    }
    .cta-button:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(233, 77, 110, 0.5); }
    .cta-button:disabled { background: #ccc; cursor: not-allowed; }

    /* --- Speaker Icon --- */
    #speaker-icon { position: fixed; top: 20px; right: 20px; font-size: 1.8rem; color: white; cursor: pointer; z-index: 1000; text-shadow: 2px 2px 5px rgba(0,0,0,0.4); }

    /* --- Form & Profile Page --- */
    .form-container { width: 90%; max-width: 450px; padding: 40px 30px; background: var(--card-bg); backdrop-filter: var(--blur-effect); border: 1px solid rgba(255, 255, 255, 0.4); border-radius: 20px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2); }
    .form-container h2 { font-family: 'Poppins', serif; font-size: 2rem; color: var(--text-color); margin-bottom: 30px; }
    .input-group { margin-bottom: 20px; position: relative;}
    .input-field { width: 100%; padding: 15px; border: 1px solid rgba(0,0,0,0.1); border-radius: 10px; background-color: rgba(255,255,255,0.7); font-size: 1rem; color: var(--text-color); }
    .back-link { display: inline-block; margin-top: 15px; color: var(--text-color); text-decoration: none; font-weight: 600; }
    
    /* --- Home Page with Blurred Background --- */
    #home-page {
        position: relative;
        justify-content: flex-start; /* Align content to the top */
        padding-top: 20px;
    }
    #home-page::before {
        content: '';
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: url('Leonardo_Phoenix_10_A_beautiful_festive_background_for_a_Raks_3.jpg') no-repeat center center/cover;
        filter: blur(8px);
        z-index: 0;
    }
    .home-content-wrapper {
        position: relative;
        z-index: 1;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    .home-header {
        width: 100%;
        padding: 20px;
        background: transparent;
    }
    .home-header .title { margin: 0; font-size: 2.5rem; text-align: center; }
    #home-page .content-area { display: flex; flex-direction: column; align-items: center; width: 100%; gap: 15px; max-width: 500px; flex-grow: 1; justify-content: center; }
    .cards-container { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; width: 100%; }
    .home-card-wrapper { display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .home-card { width: 100%; aspect-ratio: 1 / 1; background-size: cover; background-position: center; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); cursor: pointer; transition: transform 0.3s ease; border: 1px solid rgba(255,255,255,0.3); }
    .home-card:hover { transform: scale(1.05); }
    #home-page .cta-button { margin-top: 0; width: 100%; padding: 12px 20px; font-size: 1rem; border-radius: 15px; }
    .home-footer { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 15px; margin-top: auto; padding: 20px 0; }
    .footer-strip { width: 100%; padding: 15px 25px; font-size: 1.1rem; font-weight: 600; color: #fff; background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 15px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 10px; }
    
    /* --- Profile Page --- */
    #profile-page .profile-info { text-align: left; width: 100%; }
    #profile-page .profile-info p { margin-bottom: 20px; color: var(--text-color); font-weight: 600; }
    #profile-page .profile-info span { font-weight: 400; word-break: break-all; background: rgba(0,0,0,0.2); padding: 5px 8px; border-radius: 8px; color: white; text-shadow: 1px 1px 2px rgba(0,0,0,0.4); }

    /* --- Main Interface Page (Book Design) --- */
    #main-interface-page { overflow: hidden; position: relative; }
    #main-interface-page::before {
        content: '';
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: url('Leonardo_Phoenix_10_A_beautiful_festive_background_for_a_Raks_3.jpg') no-repeat center center/cover;
        filter: blur(8px);
        z-index: 0;
    }
    #main-interface-page .page-content { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; position: relative; z-index: 2; }
    .book-container { display: flex; gap: 15px; perspective: 1500px; }
    .interface-card { flex-shrink: 0; width: 45vw; max-width: 280px; aspect-ratio: 9 / 16; border-radius: 20px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); position: relative; border: 2px solid rgba(255,255,255,0.5); background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(15px); transform-style: preserve-3d; transition: transform 1s; }
    #main-interface-page.active .video-card-book { transform: rotateY(0deg); animation: open-left-cover 2s ease-out forwards; }
    #main-interface-page.active .message-card-book { transform: rotateY(0deg); animation: open-right-cover 2s ease-out forwards; }
    .video-card-book { transform-origin: right center; transform: rotateY(-180deg); }
    .message-card-book { transform-origin: left center; transform: rotateY(180deg); }
    @keyframes open-left-cover { from { transform: rotateY(-180deg); } to { transform: rotateY(0deg); } }
    @keyframes open-right-cover { from { transform: rotateY(180deg); } to { transform: rotateY(0deg); } }
    .interface-card video { width: 100%; height: 100%; object-fit: cover; border-radius: 18px; }
    .date-display { position: absolute; top: 15px; left: 50%; transform: translateX(-50%); color: #fff; background: rgba(233, 77, 110, 0.7); padding: 5px 15px; border-radius: 12px; font-size: clamp(0.7rem, 2vw, 0.9rem); font-weight: 600; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); z-index: 5; white-space: nowrap; }
    #main-interface-message-container { display: flex; flex-direction: column; justify-content: center; padding: 25px; overflow: hidden; }
    #main-interface-message { color: white; text-shadow: 1px 1px 4px rgba(0,0,0,0.8); font-size: clamp(0.85rem, 2vw, 1.1rem); line-height: 1.7; text-align: left; overflow-y: auto; height: 100%; }
    #replay-speech-btn { font-size: 1.6rem; cursor: pointer; color: white; background: rgba(0,0,0,0.2); border-radius: 50%; padding: 8px; position: absolute; bottom: 15px; right: 15px; transition: transform 0.2s; }
    #mystery-box-btn { font-size: 4rem; cursor: pointer; margin-top: 20px; background: none; border: none; animation: pulse 2s infinite; text-shadow: 0 0 15px gold; }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    @media (max-width: 700px) { .book-container { gap: 10px; } .interface-card { width: 45vw; } #main-interface-message { font-size: 0.8rem; line-height: 1.6; } }

    /* --- Falling Flowers Animation --- */
    #falling-elements-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: 3; pointer-events: none; }
    .falling-element { position: absolute; top: -50px; animation: fall linear infinite; font-size: 1.5rem; }
    @keyframes fall { to { transform: translateY(105vh) rotate(360deg); } }

    /* --- Message Display Page Specific --- */
    #message-display-page .form-container { display: flex; flex-direction: column; height: 100%; }
    #message-display-card-container { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; flex-grow: 1; }
    #message-display-card { width: 100%; min-height: 250px; flex-grow: 1; padding: 25px; background: rgba(255,255,255,0.7); border-radius: 15px; font-size: 1.1rem; line-height: 1.6; color: var(--text-color); display: flex; align-items: center; justify-content: center; text-align: center; margin-bottom: 10px; white-space: pre-wrap; }
    #whatsapp-share-icon { cursor: pointer; margin-top: 10px; }

    /* --- Unique ID Modal & Shared Message Display --- */
    #unique-id-modal, #shared-message-display { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; justify-content: center; align-items: center; z-index: 2000; }
    #unique-id-modal { background: rgba(0,0,0,0.7); }
    #shared-message-display { background: url('Leonardo_Phoenix_10_A_beautiful_festive_background_for_a_Raks_3.jpg') no-repeat center center/cover; z-index: 3000; }
    #unique-id-modal.active, #shared-message-display.active { display: flex; flex-direction: column; }
    #shared-message-content { background: var(--card-bg); backdrop-filter: var(--blur-effect); padding: 40px; border-radius: 20px; color: var(--text-color); text-shadow: 1px 1px 2px rgba(255,255,255,0.4); max-width: 90%; text-align: center; font-size: 1.2rem; line-height: 1.7; font-weight: 600; }
    #shared-message-open-btn { margin-top: 20px; }
</style>
</head>
<body>


<audio id="background-audio" loop><source src="3.m4a" type="audio/mp4"></source></audio>

<div id="speaker-icon">üîá</div>

<!-- Shared Message Display -->
<div id="shared-message-display">
    <div id="shared-message-content"></div>
    <button id="shared-message-open-btn" class="cta-button">‡§ì‡§™‡§®</button>
</div>


<!-- Unique ID Input Modal -->
<div id="unique-id-modal">
    <div class="form-container">
        <h2>‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡•á‡§Ç</h2>
        <form id="unique-id-form">
            <div class="input-group"><input type="text" id="unique-id-input" class="input-field" placeholder="‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§π‡•Å‡§Ü 5-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç" required="" maxlength="5" minlength="5"></div>
            <button type="submit" class="cta-button">‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
        </form>
    </div>
</div>

<!-- Page 1: Landing Page -->
<div id="landing-page" class="page active">
    <h1 class="title">Raksha Sutra</h1>
    <div class="video-card"><video autoplay="" loop="" muted="" playsinline=""><source src="Generated File August 07, 2025 - 7_34PM.mp4" type="video/mp4"></video></div>
    <p class="subtitle">"‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§è‡§ï ‡§ß‡§æ‡§ó‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§¶‡§ø‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§è‡§ï ‡§Ö‡§ü‡•Ç‡§ü ‡§¨‡§Ç‡§ß‡§® ‡§π‡•à‡•§<br>‡§Ü‡§á‡§è ‡§á‡§∏ ‡§∞‡§ø‡§∂‡•ç‡§§‡•á ‡§ï‡•ã ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§Æ‡§π‡§∏‡•Ç‡§∏ ‡§ï‡§∞‡•á‡§Ç, ‡§è‡§ï ‡§™‡•ç‡§Ø‡§æ‡§∞ ‡§≠‡§∞‡•Ä ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∞‡§æ‡§ñ‡•Ä ‡§ï‡•á ‡§∏‡§æ‡§•‡•§"</p>
    <button id="get-started-btn" class="cta-button">‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
</div>

<!-- Page 2: Info Form Page -->
<div id="form-page" class="page">
    <div class="form-container">
        <h2>‡§Ö‡§™‡§®‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç</h2>
        <form id="info-form">
            <div class="input-group"><input type="text" id="name" class="input-field" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ" required=""></div>
            <div class="input-group"><input type="tel" id="phone" class="input-field" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (‡§Ø‡§π ‡§Ü‡§™‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§π‡•ã‡§ó‡•Ä)" required=""></div>
            <div class="input-group"><textarea id="address" rows="3" class="input-field" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§™‡§§‡§æ" required=""></textarea></div>
            <button type="submit" class="cta-button">‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
        </form>
    </div>
</div>

<!-- Page 3: Main Interface Page -->
<div id="main-interface-page" class="page">
    <div id="falling-elements-container"></div>
    <div class="page-content">
        <div class="book-container">
            <!-- Video Card -->
            <div class="interface-card video-card-book">
                 <div class="date-display">‡§∂‡§®‡§ø‡§µ‡§æ‡§∞, 9 ‡§Ö‡§ó‡§∏‡•ç‡§§, 2025</div>
                <video playsinline="" id="main-video-player"></video>
            </div>
            <!-- Message Card -->
            <div class="interface-card message-card-book" id="main-interface-message-container">
                <div id="main-interface-message"></div>
                <div id="replay-speech-btn">üîä</div>
            </div>
        </div>
        <button id="mystery-box-btn">üéÅ</button>
    </div>
</div>


<!-- Page 4: Home Page -->
<div id="home-page" class="page">
    <div class="home-content-wrapper">
        <header class="home-header"><h1 class="title">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞</h1></header>
        <div class="content-area">
            <div class="cards-container">
                <div class="home-card-wrapper">
                    <div id="message-card-btn" class="home-card" style="background-image: url('https://i.pinimg.com/564x/f3/07/72/f3077227d8137345a5f17849e7a83850.jpg');"></div>
                    <button id="open-message-creator-btn" class="cta-button">‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≠‡•á‡§ú‡•á‡§Ç</button>
                </div>
                <div class="home-card-wrapper">
                    <div id="card-creator-btn" class="home-card" style="background-image: url('https://i.pinimg.com/564x/a4/09/b7/a409b78a0505139046467332a6136d42.jpg');"></div>
                    <button id="open-card-creator-btn" class="cta-button">‡§ï‡§æ‡§∞‡•ç‡§° ‡§¨‡§®‡§æ‡§è‡§Ç</button>
                </div>
            </div>
        </div>
        <div class="home-footer">
            <div id="my-profile-strip" class="footer-strip">‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤</div>
            <div id="change-music-strip" class="footer-strip">‡§∏‡§Ç‡§ó‡•Ä‡§§ ‡§¨‡§¶‡§≤‡•á‡§Ç</div>
            <div id="view-shared-message-btn" class="footer-strip">‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡•á‡§Ç</div>
            <div id="whatsapp-share-strip" class="footer-strip">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.22 13.91c-.2.12-.72.35-1.03.2-1.74-.87-2.86-2.8-2.95-3.03-.09-.23.53-1.08.62-1.2.09-.12.04-.23-.04-.35-.08-.12-.72-.87-.98-1.17-.26-.3-.53-.42-.72-.42-.18 0-.39.06-.58.12-.2.06-1.12.53-1.35 1.74-.23 1.2.78 2.95.87 3.03.09.08 1.74 2.8 4.22 3.72 2.48.92 2.86.72 3.38.66.52-.06 1.63-.66 1.86-1.3.23-.63.23-1.17.17-1.3-.06-.13-.23-.2-.48-.32s-.72-.36-.84-.41c-.12-.06-.2-.09-.29.09s-.32.41-.39.49c-.08.08-.15.09-.29.03z"></path></svg>
                <span>‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§™‡§∞ ‡§∂‡•á‡§Ø‡§∞ ‡§ï‡§∞‡•á‡§Ç</span>
            </div>
        </div>
    </div>
</div>

<!-- Page 5: My Profile Page -->
<div id="profile-page" class="page">
    <div class="form-container">
        <h2>‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤</h2>
        <div class="profile-info">
            <p>‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ:</p>
            <div class="input-group"><input type="text" id="profile-name-input" class="input-field" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required=""></div>
            <p>‡§Ü‡§™‡§ï‡§æ ‡§™‡§§‡§æ:</p>
            <div class="input-group"><textarea id="profile-address-input" class="input-field" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§™‡§§‡§æ" rows="3" required=""></textarea></div>
            <p>‡§Ü‡§™‡§ï‡•Ä ‡§Ü‡§à‡§°‡•Ä: <span id="profile-call-id">‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</span></p>
        </div>
        <button id="update-profile-btn" class="cta-button">‡§™‡•ç‡§∞‡•ã‡§´‡§æ‡§á‡§≤ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</button>
        <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>


<!-- Page 6: Music Change Page -->
<div id="music-page" class="page">
     <div class="form-container">
        <h2>‡§∏‡§Ç‡§ó‡•Ä‡§§ ‡§¨‡§¶‡§≤‡•á‡§Ç</h2>
        <button class="cta-button music-btn" data-src="1.m4a">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ó‡•Ä‡§§ 1</button>
        <button class="cta-button music-btn" data-src="2.m4a">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ó‡•Ä‡§§ 2</button>
        <button class="cta-button music-btn" data-src="3.m4a">‡§∞‡§ï‡•ç‡§∑‡§æ ‡§∏‡•Ç‡§§‡•ç‡§∞ ‡§∏‡§Ç‡§ó‡•Ä‡§§ 3</button>
        <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 7: Pre-made Message Creator Page -->
<div id="message-creator-page" class="page">
    <div class="form-container">
        <h2 id="message-creator-title">‡§è‡§ï ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¨‡§®‡§æ‡§è‡§Ç</h2>
        <button id="bhai-to-bhen-btn" class="cta-button" style="width:100%; margin-bottom: 15px;">‡§≠‡§æ‡§à ‡§ï‡•Ä ‡§§‡§∞‡§´ ‡§∏‡•á ‡§¨‡§π‡§® ‡§ï‡•á ‡§≤‡§ø‡§è</button>
        <button id="bhen-to-bhai-btn" class="cta-button" style="width:100%;">‡§¨‡§π‡§® ‡§ï‡•Ä ‡§§‡§∞‡§´ ‡§∏‡•á ‡§≠‡§æ‡§à ‡§ï‡•á ‡§≤‡§ø‡§è</button>
         <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 8: Name Input for Messages -->
<div id="message-name-form-page" class="page">
    <div class="form-container">
        <h2 id="message-name-title">‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</h2>
        <form id="message-name-form">
            <div class="input-group"><input type="text" id="sender-name" class="input-field" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required=""></div>
            <div class="input-group"><input type="text" id="receiver-name" class="input-field" placeholder="‡§≠‡§æ‡§à/‡§¨‡§π‡§® ‡§ï‡§æ ‡§®‡§æ‡§Æ" required=""></div>
            <button type="submit" class="cta-button">‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡•á‡§Ç</button>
        </form>
        <a href="#" class="back-link" data-target="message-creator-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 9: Message Display Page -->
<div id="message-display-page" class="page">
     <div class="form-container">
        <h2>‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§™‡•ç‡§Ø‡§æ‡§∞‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂</h2>
        <div id="message-display-card-container">
            <div id="message-display-card"></div>
            <p style="color: #555; margin-top: 10px; font-style: italic; font-size: 0.9rem;">‡§Ö‡§ó‡§≤‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡§æ‡§è‡§Ç ‡§Ø‡§æ ‡§¨‡§æ‡§è‡§Ç ‡§∏‡•ç‡§µ‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç</p>
            <div id="whatsapp-share-icon">
                <svg xmlns="http://www.w3.org/2000/svg" height="48px" viewBox="0 0 24 24" width="48px" fill="#25D366"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.22 13.91c-.2.12-.72.35-1.03.2-1.74-.87-2.86-2.8-2.95-3.03-.09-.23.53-1.08.62-1.2.09-.12.04-.23-.04-.35-.08-.12-.72-.87-.98-1.17-.26-.3-.53-.42-.72-.42-.18 0-.39.06-.58.12-.2.06-1.12.53-1.35 1.74-.23 1.2.78 2.95.87 3.03.09.08 1.74 2.8 4.22 3.72 2.48.92 2.86.72 3.38.66.52-.06 1.63-.66 1.86-1.3.23-.63.23-1.17.17-1.3-.06-.13-.23-.2-.48-.32s-.72-.36-.84-.41c-.12-.06-.2-.09-.29.09s-.32.41-.39.49c-.08.08-.15.09-.29.03z"></path></svg>
            </div>
        </div>
        <a href="#" class="back-link" data-target="message-name-form-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>


<!-- Page 10: Card Message Input Page -->
<div id="card-message-input-page" class="page">
    <div class="form-container">
        <h2>‡§Ö‡§™‡§®‡§æ ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≤‡§ø‡§ñ‡•á‡§Ç</h2>
        <div class="input-group">
            <textarea id="card-wish-input" class="input-field" placeholder="‡§Ø‡§π‡§æ‡§Ç ‡§Ö‡§™‡§®‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ ‡§≤‡§ø‡§ñ‡•á‡§Ç..." required="" rows="5"></textarea>
        </div>
        <button id="go-to-editor-btn" class="cta-button">‡§á‡§Æ‡•á‡§ú ‡§¨‡§®‡§æ‡§è‡§Ç</button>
        <a href="#" class="back-link" data-target="home-page">‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç</a>
    </div>
</div>

<!-- Page 11: Card Editor Page -->
<div id="card-editor-page" class="page">
    <div class="editor-header">
        <button id="editor-back-btn" class="editor-btn">‡§µ‡§æ‡§™‡§∏</button>
        <a id="editor-download-btn" class="editor-btn download-btn" href="#" download="rakhi-wish.png">‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</a>
    </div>
    <canvas id="editor-canvas"></canvas>
    <div id="card-gallery" class="card-gallery-container">
    </div>
</div>

<!-- Firebase SDKs -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
    
    const firebaseConfig = {
        apiKey: "AIzaSyB2PG5JvDko2UmQDlY9gN5lBgga2vQy-Ws",
        authDomain: "conceptra-c1000.firebaseapp.com",
        databaseURL: "https://conceptra-c1000-default-rtdb.firebaseio.com",
        projectId: "conceptra-c1000",
        storageBucket: "conceptra-c1000.firebasestorage.app",
        messagingSenderId: "298402987968",
        appId: "1:298402987968:web:c0d0d7d6c08cdfa6bc5225",
        measurementId: "G-QRQYEVSJJ6"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const pages = document.querySelectorAll('.page');
    const audio = document.getElementById('background-audio');
    const speakerIcon = document.getElementById('speaker-icon');
    let isMusicPlaying = false;
    let fallingElementsInterval;
    
    let messageType = ''; 
    let currentMessageIndex = 0;
    const messages = { 'bhai-to-bhen': [ "‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§¨‡§π‡§®‡§æ, ‡§Ø‡§π ‡§∞‡§æ‡§ñ‡•Ä ‡§ï‡§æ ‡§ß‡§æ‡§ó‡§æ ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§è‡§ï ‡§ß‡§æ‡§ó‡§æ ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§Æ‡•á‡§∞‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞ ‡§î‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§æ ‡§µ‡§æ‡§¶‡§æ ‡§π‡•à ‡§ú‡•ã ‡§Æ‡•à‡§Ç ‡§§‡•Å‡§Æ‡§∏‡•á ‡§ú‡•Ä‡§µ‡§® ‡§≠‡§∞ ‡§®‡§ø‡§≠‡§æ‡§ä‡§Ç‡§ó‡§æ‡•§ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡•Ä ‡§¨‡§π‡•Å‡§§-‡§¨‡§π‡•Å‡§§ ‡§¨‡§ß‡§æ‡§à!", "‡§¨‡§ö‡§™‡§® ‡§ï‡•Ä ‡§µ‡•ã ‡§ñ‡§ü‡•ç‡§ü‡•Ä-‡§Æ‡•Ä‡§†‡•Ä ‡§Ø‡§æ‡§¶‡•á‡§Ç ‡§Ü‡§ú ‡§≠‡•Ä ‡§ö‡•á‡§π‡§∞‡•á ‡§™‡§∞ ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§æ‡§® ‡§≤‡•á ‡§Ü‡§§‡•Ä ‡§π‡•à‡§Ç‡•§ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ ‡§π‡•ã‡§®‡§æ ‡§Æ‡•á‡§∞‡•á ‡§ú‡•Ä‡§µ‡§® ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§§‡•ã‡§π‡§´‡§æ ‡§π‡•à‡•§ ‡§π‡•à‡§™‡•ç‡§™‡•Ä ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§®, ‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§¨‡§π‡§®!", ], 'bhen-to-bhai': [ "‡§Æ‡•á‡§∞‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•á ‡§≠‡§æ‡§à, ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§ï‡§≤‡§æ‡§à ‡§™‡§∞ ‡§Ø‡§π ‡§∞‡§æ‡§ñ‡•Ä ‡§¨‡§æ‡§Ç‡§ß‡§ï‡§∞ ‡§Æ‡•à‡§Ç ‡§≠‡§ó‡§µ‡§æ‡§® ‡§∏‡•á ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§≤‡§Ç‡§¨‡•Ä ‡§â‡§Æ‡•ç‡§∞ ‡§î‡§∞ ‡§∏‡§´‡§≤‡§§‡§æ ‡§ï‡•Ä ‡§ï‡§æ‡§Æ‡§®‡§æ ‡§ï‡§∞‡§§‡•Ä ‡§π‡•Ç‡§Å‡•§ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Å!", "‡§§‡•Å‡§Æ ‡§Æ‡•á‡§∞‡•á ‡§™‡§π‡§≤‡•á ‡§¶‡•ã‡§∏‡•ç‡§§ ‡§î‡§∞ ‡§Æ‡•á‡§∞‡•á ‡§∏‡•Å‡§™‡§∞‡§π‡•Ä‡§∞‡•ã ‡§π‡•ã‡•§ ‡§Æ‡•Å‡§ù‡•á ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§Æ‡§π‡§∏‡•Ç‡§∏ ‡§ï‡§∞‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶‡•§ ‡§π‡•à‡§™‡•ç‡§™‡•Ä ‡§∞‡§æ‡§ñ‡•Ä ‡§≠‡•à‡§Ø‡§æ!", ] };
    const mainVideoPlayer = document.getElementById('main-video-player');
    const mainInterfaceVideos = [ 'main interfacemp4.mp4', 'coming soon rakshabandhan __ 9 August 2025 _comingsoon _rakhi_happyrakshabandhan_status_short(360P).mp4', ];
    let currentMainVideoIndex = 0;
    
    function generateUniqueId() {
        return Math.random().toString(36).substring(2, 7); // 5-char alphanumeric
    }
    
    async function showSharedMessage(messageId) {
        const uniqueIdModal = document.getElementById('unique-id-modal');
        const sharedMessageDisplay = document.getElementById('shared-message-display');
        const sharedMessageContent = document.getElementById('shared-message-content');
        
        uniqueIdModal.classList.remove('active');
        
        try {
            const messageDocRef = doc(db, "sharedMessages", messageId);
            const docSnap = await getDoc(messageDocRef);
            if (docSnap.exists()) {
                sharedMessageContent.textContent = docSnap.data().message;
                sharedMessageDisplay.classList.add('active');
            } else {
                alert("‡§Ø‡§π ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§ï‡•ã‡§° ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§");
                uniqueIdModal.classList.add('active');
            }
        } catch(e) {
             alert("‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§");
             console.error(e);
        }
    }

    async function loadProfileForEditing() {
        const userId = localStorage.getItem('rakshaSutraUserId');
        if (!userId) {
            alert("‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡•É‡§§ ‡§π‡•ã‡§®‡§æ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§");
            showPage('form-page');
            return;
        }
        document.getElementById('profile-call-id').textContent = userId;
        try {
            const userDocRef = doc(db, "users", userId);
            const docSnap = await getDoc(userDocRef);
            if (docSnap.exists()) {
                const userData = docSnap.data();
                document.getElementById('profile-name-input').value = userData.name || '';
                document.getElementById('profile-address-input').value = userData.address || '';
            } else {
                localStorage.clear();
                showPage('form-page');
            }
        } catch (error) {
            console.error("Error getting document:", error);
            alert("‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à: " + error.message);
        }
    }

    function showPage(pageId) {
        document.querySelectorAll('.page.active').forEach(p => p.classList.remove('active'));
        const page = document.getElementById(pageId);
        if (page) {
            page.classList.add('active');
        }

        if (pageId === 'main-interface-page') {
            startFallingElements();
            if (localStorage.getItem('musicWasPlaying') === 'true' && !audio.playing) {
                audio.play().catch(()=>{});
            }
            mainVideoPlayer.muted = false;
            mainVideoPlayer.play().catch(e => console.log("Autoplay was prevented."));
        } else {
             if (fallingElementsInterval) {
                clearInterval(fallingElementsInterval);
                document.getElementById('falling-elements-container').innerHTML = '';
             }
        }
        
        if (pageId === 'profile-page') {
            loadProfileForEditing();
        }
    }

    function toggleMusic() {
        if (audio.paused) {
            audio.play().then(() => {
                speakerIcon.textContent = 'üîä';
                isMusicPlaying = true;
                localStorage.setItem('musicWasPlaying', 'true');
            }).catch(() => { isMusicPlaying = false; });
        } else {
            audio.pause();
            speakerIcon.textContent = 'üîá';
            isMusicPlaying = false;
            localStorage.setItem('musicWasPlaying', 'false');
        }
    }
    
    function startFallingElements() {
        if (fallingElementsInterval) clearInterval(fallingElementsInterval);
        const container = document.getElementById('falling-elements-container');
        container.innerHTML = '';
        const elements = ['üå∫', 'üåπ', 'üå∏', 'üå∑', 'üåº', 'üèµÔ∏è', 'üíÆ'];
        fallingElementsInterval = setInterval(() => {
            const element = document.createElement('div');
            element.className = 'falling-element';
            element.textContent = elements[Math.floor(Math.random() * elements.length)];
            element.style.left = Math.random() * 100 + 'vw';
            element.style.animationDuration = Math.random() * 5 + 5 + 's';
            element.style.fontSize = Math.random() * 1.5 + 1 + 'rem';
            container.appendChild(element);
            setTimeout(() => { element.remove(); }, 10000);
        }, 300);
    }

    function speakMessage(text) {
        if (!window.speechSynthesis) return;
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'hi-IN';
        utterance.rate = 0.9;
        utterance.pitch = 1.1;
        window.speechSynthesis.speak(utterance);
    }

    function setupMainInterfacePage(userName) {
        const messageText = `‡§™‡•ç‡§∞‡§ø‡§Ø ${userName},\n\n‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡§æ ‡§Ø‡§π ‡§™‡§æ‡§µ‡§® ‡§Ö‡§µ‡§∏‡§∞ ‡§™‡•ç‡§∞‡•á‡§Æ, ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§î‡§∞ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§â‡§∏ ‡§¨‡§Ç‡§ß‡§® ‡§ï‡§æ ‡§™‡•ç‡§∞‡§§‡•Ä‡§ï ‡§π‡•à ‡§ú‡•ã ‡§π‡§Æ‡•á‡§Ç ‡§ú‡•Ä‡§µ‡§®‡§≠‡§∞ ‡§ú‡•ã‡§°‡§º‡•á ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à‡•§\n‡§π‡§Æ‡§æ‡§∞‡•á Shubhzone.shop ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞ ‡§ï‡§æ ‡§π‡§ø‡§∏‡•ç‡§∏‡§æ ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡§æ ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶‡•§ ‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§∂‡•ç‡§µ‡§æ‡§∏ ‡§π‡§Æ‡§æ‡§∞‡•á ‡§≤‡§ø‡§è ‡§µ‡•à‡§∏‡§æ ‡§π‡•Ä ‡§π‡•à ‡§ú‡•à‡§∏‡•á ‡§è‡§ï ‡§¨‡§π‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡•á ‡§≠‡§æ‡§à ‡§ï‡§æ ‡§µ‡§ö‡§®‚Äî ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡§æ‡§• ‡§®‡§ø‡§≠‡§æ‡§®‡•á ‡§ï‡§æ‡•§\n\n‡§á‡§∏ ‡§§‡•ç‡§Ø‡•ã‡§π‡§æ‡§∞ ‡§™‡§∞ ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§Ø‡§π‡•Ä ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ ‡§π‡•à ‡§ï‡§ø ‡§Ü‡§™‡§ï‡•á ‡§ú‡•Ä‡§µ‡§® ‡§Æ‡•á‡§Ç ‡§π‡§Æ‡•á‡§∂‡§æ ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡§æ‡§Ç, ‡§∏‡§´‡§≤‡§§‡§æ ‡§î‡§∞ ‡§∞‡§ø‡§∂‡•ç‡§§‡•ã‡§Ç ‡§ï‡•Ä ‡§ó‡§∞‡•ç‡§Æ‡§æ‡§π‡§ü ‡§¨‡§®‡•Ä ‡§∞‡§π‡•á‡•§\n\n‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§ï‡•Ä ‡§π‡§æ‡§∞‡•ç‡§¶‡§ø‡§ï ‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç!\n‡§∏‡§™‡•ç‡§∞‡•á‡§Æ,\nShubhzone.shop ‡§™‡§∞‡§ø‡§µ‡§æ‡§∞`;
        document.getElementById('main-interface-message').textContent = messageText;
        mainVideoPlayer.src = mainInterfaceVideos[currentMainVideoIndex];
        showPage('main-interface-page');
        setTimeout(() => speakMessage(messageText), 2500);
    }
    
    function playNextMainVideo() {
        currentMainVideoIndex = (currentMainVideoIndex + 1) % mainInterfaceVideos.length;
        mainVideoPlayer.src = mainInterfaceVideos[currentMainVideoIndex];
        mainVideoPlayer.play();
    }
    
    function displayCurrentMessage() {
        const sender = document.getElementById('sender-name').value;
        const receiver = document.getElementById('receiver-name').value;
        let messageTemplate = messages[messageType][currentMessageIndex];
        let formattedMessage = messageTemplate.replace(/‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§¨‡§π‡§®‡§æ|‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§¨‡§π‡§®|‡§¨‡§π‡§®‡§æ/g, `‡§Æ‡•á‡§∞‡•Ä ‡§™‡•ç‡§Ø‡§æ‡§∞‡•Ä ‡§¨‡§π‡§®‡§æ ${receiver}`).replace(/‡§Æ‡•á‡§∞‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•á ‡§≠‡§æ‡§à|‡§≠‡•à‡§Ø‡§æ|‡§≠‡§æ‡§à/g, `‡§Æ‡•á‡§∞‡•á ‡§™‡•ç‡§Ø‡§æ‡§∞‡•á ‡§≠‡§æ‡§à ${receiver}`);
        document.getElementById('message-display-card').textContent = formattedMessage + `\n\n‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ/‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä,\n${sender}`;
    }

    // --- Event Listeners ---
    document.addEventListener('DOMContentLoaded', () => {
        // --- Page Navigation ---
        document.getElementById('get-started-btn').addEventListener('click', () => {
            audio.play().then(() => audio.pause()).catch(() => {});
            if (localStorage.getItem('rakshaSutraUserId')) {
                setupMainInterfacePage(localStorage.getItem('rakshaSutraUserName'));
            } else {
                showPage('form-page');
            }
        });
        document.getElementById('mystery-box-btn').addEventListener('click', () => showPage('home-page'));
        document.getElementById('open-message-creator-btn').addEventListener('click', () => showPage('message-creator-page'));
        document.getElementById('open-card-creator-btn').addEventListener('click', () => showPage('card-message-input-page'));
        document.getElementById('change-music-strip').addEventListener('click', () => showPage('music-page'));
        document.getElementById('my-profile-strip').addEventListener('click', () => showPage('profile-page'));
        document.getElementById('view-shared-message-btn').addEventListener('click', () => document.getElementById('unique-id-modal').classList.add('active'));
        
        document.querySelectorAll('.back-link').forEach(link => {
            link.addEventListener('click', (e) => { e.preventDefault(); showPage(link.dataset.target); });
        });
        
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('msg')) {
            document.getElementById('unique-id-modal').classList.add('active');
        } else {
            showPage('landing-page');
        }
        
        // --- Forms ---
        document.getElementById('info-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btn = e.target.querySelector('button[type="submit"]');
            btn.disabled = true;
            btn.textContent = '‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...';
            const phone = document.getElementById('phone').value, name = document.getElementById('name').value, address = document.getElementById('address').value;
            try {
                await setDoc(doc(db, "users", phone), { name, phone, address, timestamp: serverTimestamp() });
                localStorage.setItem('rakshaSutraUserName', name);
                localStorage.setItem('rakshaSutraUserId', phone);
                alert(`‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶, ${name}! ‡§Ü‡§™‡§ï‡•Ä ‡§™‡•ç‡§∞‡•ã‡§´‡§º‡§æ‡§á‡§≤ ‡§¨‡§® ‡§ó‡§à ‡§π‡•à‡•§`);
                setupMainInterfacePage(name);
            } catch (error) {
                alert("‡§è‡§ï ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à: " + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = '‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡•á‡§Ç';
            }
        });
        
        document.getElementById('unique-id-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const enteredId = document.getElementById('unique-id-input').value.toLowerCase();
            if (enteredId && enteredId.length === 5) {
                showSharedMessage(enteredId);
            } else {
                alert("‡§ï‡•É‡§™‡§Ø‡§æ 5-‡§Ö‡§Ç‡§ï‡•Ä‡§Ø ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç‡•§");
            }
        });
        
        document.getElementById('message-name-form').addEventListener('submit', (e) => {
            e.preventDefault();
            currentMessageIndex = 0;
            displayCurrentMessage();
            showPage('message-display-page');
        });
        
        // --- Other Functionality ---
        speakerIcon.addEventListener('click', toggleMusic);
        mainVideoPlayer.addEventListener('ended', playNextMainVideo);
        
        document.getElementById('shared-message-open-btn').addEventListener('click', () => {
            document.getElementById('shared-message-display').classList.remove('active');
            if (localStorage.getItem('rakshaSutraUserId')) {
                setupMainInterfacePage(localStorage.getItem('rakshaSutraUserName'));
            } else {
                showPage('form-page');
            }
        });

        document.getElementById('whatsapp-share-strip').addEventListener('click', () => {
            const message = encodeURIComponent(`‡§á‡§∏ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§®, ‡§Ö‡§™‡§®‡•á ‡§≠‡§æ‡§à-‡§¨‡§π‡§® ‡§ï‡•ã ‡§è‡§ï ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∞‡§æ‡§ñ‡•Ä ‡§≠‡•á‡§ú‡•á‡§Ç! ‡§á‡§∏ ‡§ñ‡•Ç‡§¨‡§∏‡•Ç‡§∞‡§§ ‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡•ã ‡§¶‡•á‡§ñ‡•á‡§Ç: ${window.location.origin}`);
            window.open(`https://api.whatsapp.com/send?text=${message}`, '_blank');
        });
        
        document.getElementById('whatsapp-share-icon').addEventListener('click', async () => {
            const messageToShare = document.getElementById('message-display-card').textContent;
            const uniqueId = generateUniqueId();
            try {
                await setDoc(doc(db, "sharedMessages", uniqueId), { message: messageToShare, createdAt: serverTimestamp() });
                const shareUrl = `${window.location.origin}${window.location.pathname}?msg=true`;
                const shareText = encodeURIComponent(`‡§Ü‡§™‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ñ‡§æ‡§∏ ‡§∞‡§ï‡•ç‡§∑‡§æ‡§¨‡§Ç‡§ß‡§® ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§π‡•à! üéÅ\n\n‡§á‡§∏‡•á ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡§ø‡§Ç‡§ï ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§Ø‡§π ‡§Ø‡•Ç‡§®‡§ø‡§ï ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç: *${uniqueId.toUpperCase()}*\n\n${shareUrl}`);
                window.open(`https://api.whatsapp.com/send?text=${shareText}`, '_blank');
            } catch(e) {
                alert("‡§∂‡•á‡§Ø‡§∞ ‡§≤‡§ø‡§Ç‡§ï ‡§¨‡§®‡§æ‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø ‡§π‡•Å‡§à‡•§");
            }
        });

        document.querySelectorAll('.music-btn').forEach(button => {
            button.addEventListener('click', () => {
                audio.src = button.dataset.src;
                if (isMusicPlaying) audio.play(); else toggleMusic();
                showPage('home-page');
            });
        });

        document.getElementById('bhai-to-bhen-btn').addEventListener('click', () => { messageType = 'bhai-to-bhen'; showPage('message-name-form-page'); });
        document.getElementById('bhen-to-bhai-btn').addEventListener('click', () => { messageType = 'bhen-to-bhai'; showPage('message-name-form-page'); });
    });
</script>

</body>
</html>```
